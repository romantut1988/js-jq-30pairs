<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JavaScript</title>
</head>

<body>
    <!-- Что такое cookie? -->
    <!-- Эти дополнительные данные получили название Cookie (от англ. «выпечка, печенье», произносится как «куки» и не 
переводится). Можно сравнить Cookie с теми пирожками, которые несла в корзинке (НТТР-пакете) Красная Шапочка от Матери 
(сервера) к Бабушке (клиенту). По формализму, Cookie похожи на POST-данные, включаемые формой с соответствующим методом 
отправки. Они не видны в адресной строке браузера, для того чтобы их просмотреть нужно проанализировать сам НТТР пакет. 
Cookie автоматически обрабатываются браузером — сохраняются на компьютере пользователя при загрузке страницы и 
добавляются в пакет, когда формируется новый запрос к серверу. Участие пользователя в этом процессе не требуется. На 
внешний вид страницы Cookie, сами по себе, никак не влияют. Установить, добавить или удалить Cookie может как сервер, 
так и клиент. Вне зависимости от того, кто первый установил Cookie, они будут автоматически включаться во все пакеты, 
которыми обмениваются клиент и сервер при дальнейших коммуникациях.-->



    <!-- Создание, использование и удаление Cookie -->
    <!-- Отметим некоторые их особенности, отличающие Cookie от других объектов JavaScript, и отражающиеся на их описании.
Начнем с того, что Cookie передается в составе НТТР пакета, то есть является текстовым элементом, как и все остальное 
в этом пакете. Это означает, что описание Cookie является строкой, создание и удаление Cookie также логично 
организовывать в строковом виде. Для одного домена (сайта) может быть установлено несколько Cookie. Соответственно, 
должен существовать способ отличать Cookie между собой. Для того чтобы была возможность разделять Cookie, им были 
присвоены имена. Подобно переменным в программировании, Cookie устанавливаются инструкцией «имя=значение». Такой же 
инструкцией можно поменять значение уже установленных Cookie, использовав их имена-->
    <!-- Следующей особенностью Cookie, на этот раз в отличие от переменных, является время их действия (expires). Для 
простых систем, наподобие форума или электронной почты, этот срок может быть около дня или больше. В то же время для 
банковских операций срок ограничен часами или даже минутами. По прошествии срока действия, указанного в атрибуте 
«expires», Cookie автоматически удаляется.-->
    <!-- !Свойством «path», устанавливаемым для каждой Cookie отдельно. Наиболее общим является выражение «path=/», 
что означает доступ из всех страниц сайта. -->
    <!-- С точки зрения модели DOM, все Cookie хранятся в одной переменной «document.cookie», эта переменная является строкой.
Свойство «path»,  устанавливаем для каждой Cookie отдельно. -->
    <!-- Для добавления (создания) Cookie нужно присвоить переменной «document.cookie» новое значение. Осо бенностью 
является то, что вместо оператора «+=», применяемого для добавления строк, нужно использовать простое присваивание «=». 
Браузер сам обработает эту команду как создание Cookie, предыдущие значения не «сотрутся» -->
    <!-- Для того чтобы выполнить упражнения по работе с Cookie необходимо либо создать настоящий домен 
(локальный или сетевой), либо воспользоваться онлайн HTML — редакторами, например, «Tryit Editor»  
https://www.w3schools.com/html/tryit.asp?filename=tryhtml_basic    -->

    <!-- Пример -->
    <p id="out"></p>
    <script>
        document.cookie = "registered=User; expires = Thu, 14 Feb 2023 19:40:40 GMT; path = /";
        document.cookie = "organization=Step; expires=Thu, 14 Feb 2023 19:40:40 GMT; path=/";
        window.out.innerHTML = document.cookie;  
    </script>

    <!-- Напишем команды, которые преобразуют строку в объект: -->
    <script>
        var x = document.cookie;
        vars = x.split('; ');
        var cookieObject = {};
        var c;
        for (var i = 0; i < s.length; i++) {
            c = s[i].split('=');
            cookieObject[c[0]] = c[1];
        } 
    </script>

    <!-- Итоговый объект «cookieObject» облегчит нам работу с Cookie. Например, выведем полученные данные отдельно, 
    по одной записи в строке. Для этого используем цикл «for-in», предназначенный для обхода объектов -->
    <script>
        for (var co in cookieObject)
            window.out.innerHTML += co + " = " + cookieObject[co] + "<br />";
    </script>

    <!-- В теле цикла добавляем к содержимому абзаца «out» данные об имени Cookie «co», знак «=», значение Cookie 
    «cookieObject[co]» и разрыв строки «"<br/>"». Со строкой «innerHTML» работа ведется обычным образом, используя для 
    добавления оператор «+=». -->
    <p id="out"></p>
    <script>
        document.cookie = "registered=User; expires=Thu, 14 Feb 2023 08:12:40 GMT; path = /";
        document.cookie = "organization=Step; expires=Thu, 14 Feb 2019 08:12:40 GMT; path = /";
        var x = document.cookie;
        var s = x.split('; ');
        var cookieObject = {};
        var c;
        for (var i = 0; i < s.length; i++) {
            c = s[i].split('=');
            cookieObject[c[0]] = c[1];
        }
        for (var co in cookieObject)
            window.out.innerHTML += co + " = " +
                cookieObject[co] + "<br/>"; 
    </script>


    <!-- Создадим простейшую систему, имитирующую авторизацию пользователей. Для этого нам понадобится:
    1. Перехватить событие загрузки страницы «onload», установив для него собственный обработчик. Это позволит нам 
по-разному отображать страницу для зарегистрированных и незарегистрированных пользователей.
    2. В обработчике события нужно проверить установлено ли значение для Cookie с именем «register» (имя может быть 
произвольным, мы его сами выбираем.
    3. Если указанное значение присутствует, то выдаем приветствие пользователю. Его имя хранится как значение Cookie.
    4. Если значения нет, выводим предложение авторизоваться.
-->
    <!-- <body onload="checkReg()"> -->
    <!DOCTYPE html>
    <html>

    <body onload="checkReg()">
        <div id='regDiv'></div>

        <script>
            function checkReg() {
                var x = document.cookie;
                var rd = document.getElementById("regDiv");
                var s = x.split('; ');
                var cookieObject = {};
                var c;
                for (var i = 0; i < s.length; i++) {
                    c = s[i].split('=');
                    cookieObject[c[0]] = c[1];
                }
                if ('register' in cookieObject) {
                    rd.innerHTML = "Hello, " + cookieObject['register'];
                } else {
                    rd.innerHTML = "Name: <input type='text' id='name'/><input type='button'value = 'Register'onclick = 'regClick()' />";
                }
            }
            function regClick() {
                var inputName = document.getElementById("name");
                var name = inputName.value;
                var expDate = new Date;
                expDate.setTime((new Date).getTime() + 60 * 1000);
                document.cookie = "register=" + name + ";expires=" + expDate.toGMTString() + ";path=/";
                checkReg();
            }
        </script>

    </html>
</body>

</html>